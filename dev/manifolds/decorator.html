<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Decorator manifold · Manifolds.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.png" alt="Manifolds.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Manifolds.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Manifolds.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../interface.html">ManifoldsBase.jl</a></li><li><span class="tocitem">Manifolds</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Basic manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="choleskyspace.html">Cholesky space</a></li><li><a class="tocitem" href="circle.html">Circle</a></li><li><a class="tocitem" href="euclidean.html">Euclidean</a></li><li><a class="tocitem" href="fixedrankmatrices.html">Fixed-rank matrices</a></li><li><a class="tocitem" href="generalizedstiefel.html">Generalized Stiefel</a></li><li><a class="tocitem" href="grassmann.html">Grassmannian manifold</a></li><li><a class="tocitem" href="hyperbolic.html">Hyperbolic space</a></li><li><a class="tocitem" href="lorentz.html">Lorentzian manifold</a></li><li><a class="tocitem" href="oblique.html">Oblique manifold</a></li><li><a class="tocitem" href="rotations.html">Rotations</a></li><li><a class="tocitem" href="skewsymmetric.html">Skew-symmetric matrices</a></li><li><a class="tocitem" href="sphere.html">Sphere</a></li><li><a class="tocitem" href="stiefel.html">Stiefel</a></li><li><a class="tocitem" href="symmetric.html">Symmetric matrices</a></li><li><a class="tocitem" href="symmetricpositivedefinite.html">Symmetric positive definite</a></li><li><a class="tocitem" href="torus.html">Torus</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Combined manifolds</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="graph.html">Graph manifold</a></li><li><a class="tocitem" href="power.html">Power manifold</a></li><li><a class="tocitem" href="product.html">Product manifold</a></li><li><a class="tocitem" href="vector_bundle.html">Vector bundle</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Manifold decorators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href="decorator.html">Decorator manifold</a></li><li><a class="tocitem" href="array.html">Array manifold</a></li><li><a class="tocitem" href="embedded.html">Embedded manifold</a></li><li><a class="tocitem" href="metric.html">Metric manifold</a></li><li><a class="tocitem" href="group.html">Group manifold</a></li></ul></li></ul></li><li><a class="tocitem" href="../statistics.html">Statistics</a></li><li><a class="tocitem" href="../distributions.html">Distributions</a></li><li><a class="tocitem" href="../orthonormal_bases.html">Orthonormal bases</a></li><li><a class="tocitem" href="../notation.html">Notation</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../lib/numbers.html">Number systems</a></li><li><a class="tocitem" href="../lib/public.html">Public</a></li><li><a class="tocitem" href="../lib/internals.html">Internals</a></li><li><a class="tocitem" href="../lib/autodiff.html">Automatic differentiation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li><a class="is-disabled">Manifold decorators</a></li><li class="is-active"><a href="decorator.html">Decorator manifold</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="decorator.html">Decorator manifold</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaNLSolvers/Manifolds.jl/blob/master/docs/src/manifolds/decorator.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Decorator-manifold-1"><a class="docs-heading-anchor" href="#Decorator-manifold-1">Decorator manifold</a><a class="docs-heading-anchor-permalink" href="#Decorator-manifold-1" title="Permalink"></a></h1><p>A decorator manifold extends the functionality of a <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> in a semi-transparent way. It internally stores the <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> it extends and by default for functions defined in the <a href="../interface.html"><code>ManifoldsBase</code></a> it acts transparently in the sense that it passes all functions through to the base except those that it actually affects. For example, because the <a href="array.html#ManifoldsBase.ArrayManifold"><code>ArrayManifold</code></a> affects nearly all functions, it overwrites nearly all functions, except a few like <a href="../interface.html#ManifoldsBase.manifold_dimension-Tuple{Manifold}"><code>manifold_dimension</code></a>. On the other hand, the <a href="metric.html#Manifolds.MetricManifold"><code>MetricManifold</code></a> only affects functions that involve metrics, especially <a href="../interface.html#Base.exp-Tuple{Manifold,Any,Any}"><code>exp</code></a> and <a href="../interface.html#Base.log-Tuple{Manifold,Any,Any}"><code>log</code></a> but not the <a href="../interface.html#ManifoldsBase.manifold_dimension-Tuple{Manifold}"><code>manifold_dimension</code></a>.</p><p>By default all functions are passed down. To implement a method for a decorator that behaves differently from the method of the same function for the internal manifold, two steps are required. Let&#39;s assume the function is called <code>f(M, arg1, arg2)</code>, and our decorator manifold <code>DM</code> of type <code>OurDecoratorManifold</code> decorates <code>M</code>. Then</p><ol><li>set <code>decorator_transparent_dispatch(f, M::OurDecoratorManifold, args...) = Val(:intransparent)</code></li><li>implement <code>f(DM::OurDecoratorManifold, arg1, arg2)</code></li></ol><p>This makes it possible to extend a manifold or all manifolds with a feature or replace a feature of the original manifold. The <a href="metric.html#Manifolds.MetricManifold"><code>MetricManifold</code></a> is the best example of the second case, since the default metric indicates for which metric the manifold was originally implemented, such that those functions are just passed through. This can best be seen in the <a href="symmetricpositivedefinite.html#Manifolds.SymmetricPositiveDefinite"><code>SymmetricPositiveDefinite</code></a> manifold with its <a href="symmetricpositivedefinite.html#Manifolds.LinearAffineMetric"><code>LinearAffineMetric</code></a>.</p><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.AbstractDecoratorManifold" href="#ManifoldsBase.AbstractDecoratorManifold"><code>ManifoldsBase.AbstractDecoratorManifold</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractDecoratorManifold &lt;: Manifold</code></pre><p>An <code>AbstractDecoratorManifold</code> indicates that to some extent a manifold subtype decorates another manifold in the sense that it either</p><ul><li>it extends the functionality of a manifold with further features</li><li>it defines a new manifold that internally uses functions from the decorated manifold</li></ul><p>with the main intent that several or most functions of <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> are transparently passed through to the manifold that is decorated. This way a function implemented for a decorator acts transparent on all other decorators, i.e. they just pass them through. If the decorator the function is implemented for is not among the decorators, an error is issued. By default all base manifold functions, for example <a href="../interface.html#Base.exp-Tuple{Manifold,Any,Any}"><code>exp</code></a> and <a href="../interface.html#Base.log-Tuple{Manifold,Any,Any}"><code>log</code></a> are transparent for all decorators.</p><p>Transparency of functions with respect to decorators can be specified using the macros <a href="decorator.html#ManifoldsBase.@decorator_transparent_fallback-Tuple{Any}"><code>@decorator_transparent_fallback</code></a>, <a href="decorator.html#ManifoldsBase.@decorator_transparent_function-Tuple{Any}"><code>@decorator_transparent_function</code></a> and <a href="decorator.html#ManifoldsBase.@decorator_transparent_signature-Tuple{Any}"><code>@decorator_transparent_signature</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.@decorator_transparent_fallback-Tuple{Any}" href="#ManifoldsBase.@decorator_transparent_fallback-Tuple{Any}"><code>ManifoldsBase.@decorator_transparent_fallback</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@decorator_transparent_fallback(ex)
@decorator_transparent_fallback(fallback_case = :intransparent, ex)</code></pre><p>This macro introduces an additional implementation for a certain additional case. This can especially be used if for an already transparent function and an abstract intermediate type a change in the default is required. For implementing a concrete type, neither this nor any other trick is necessary. One just implements the function as before. Note that a decorator that <a href="decorator.html#ManifoldsBase.is_default_decorator-Tuple{Manifold}"><code>is_default_decorator</code></a> still dispatches to the transparent case.</p><ul><li><code>:transparent</code> states, that the function is transparently passed on to the manifold that is decorated by the <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a> <code>M</code>, which is determined using the function <a href="decorator.html#ManifoldsBase.decorated_manifold-Tuple{Manifold}"><code>decorated_manifold</code></a>.</li><li><code>:intransparent</code> states that an implementation for this decorator is required, and if none of the types provides one, an error is issued. Since this macro provides such an implementation, this is the default.</li><li><code>:parent</code> states, that this function passes on to the supertype instead of to the decorated manifold.</li></ul><p>Inline definitions are not supported. The function signature however may contain keyword arguments and a where clause. It does not allow for parameters with default values.</p><p><strong>Examples</strong></p><pre><code class="language-julia">@decorator_transparent_fallback function log!(M::AbstractGroupManifold, X, p, q)
    log!(decorated_manifold(M), X, p, Q)
end
@decorator_transparent_fallback :transparent function log!(M::AbstractGroupManifold, X, p, q)
    log!(decorated_manifold(M), X, p, Q)
end</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.@decorator_transparent_function-Tuple{Any}" href="#ManifoldsBase.@decorator_transparent_function-Tuple{Any}"><code>ManifoldsBase.@decorator_transparent_function</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@decorator_transparent_function(ex)
@decorator_transparent_function(fallback_case = :intransparent, ex)</code></pre><p>Introduce the function specified by <code>ex</code> to act transparently with respect to <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a>s. This introduces the possibility to modify the kind of transparency the implementation is done for. This optional first argument, the <code>Symbol</code> within <code>fallback_case</code>. This macro can be used to define a function and introduce it as transparent to other decorators. Note that a decorator that <a href="decorator.html#ManifoldsBase.is_default_decorator-Tuple{Manifold}"><code>is_default_decorator</code></a> still dispatches to the transparent case.</p><p>The cases of transparency are</p><ul><li><code>:transparent</code> states, that the function is transparently passed on to the manifold that is decorated by the <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a> <code>M</code>, which is determined using the function <a href="decorator.html#ManifoldsBase.decorated_manifold-Tuple{Manifold}"><code>decorated_manifold</code></a>.</li><li><code>:intransparent</code> states that an implementation for this decorator is required, and if none of the types provides one, an error is issued. Since this macro provides such an implementation, this is the default.</li><li><code>:parent</code> states, that this function passes on to the supertype instead of to the decorated manifold. Passing is performed using the <code>invoke</code> function where the type of manifold is replaced by its supertype.</li></ul><p>Innkoline-definitions are not yet covered – the function signature however may contain keyword arguments and a where clause.</p><p><strong>Examples</strong></p><pre><code class="language-julia">@decorator_transparent_function log!(M::AbstractDecoratorManifold, X, p, q)
    log!(decorated_manifold(M), X, p, Q)
end
@decorator_transparent_function :parent log!(M::AbstractDecoratorManifold, X, p, q)
    log!(decorated_manifold(M), X, p, Q)
end</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.@decorator_transparent_signature-Tuple{Any}" href="#ManifoldsBase.@decorator_transparent_signature-Tuple{Any}"><code>ManifoldsBase.@decorator_transparent_signature</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@decorator_transparent_signature(ex)</code></pre><p>Introduces a given function to be transparent with respect to all decorators. The function is adressed by its signature in <code>ex</code>.</p><p>Supports standard, keyword arguments and <code>where</code> clauses. Doesn&#39;t support parameters with default values. It introduces a dispatch on several transparency modes</p><p>The cases of transparency are</p><ul><li><code>:transparent</code> states, that the function is transparently passed on to the manifold that is decorated by the <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a> <code>M</code>, which is determined using the function <a href="decorator.html#ManifoldsBase.decorated_manifold-Tuple{Manifold}"><code>decorated_manifold</code></a>. This is the default.</li><li><code>:intransparent</code> states that an implementation for this decorator is required, and if none of the types provides one, an error is issued.</li><li><code>:parent</code> states, that this function passes on to the supertype instead of to the decorated manifold.</li></ul><p>Inline definitions are not supported. The function signature however may contain keyword arguments and a where clause.</p><p>The dispatch kind can later still be set to something different, see <a href="decorator.html#ManifoldsBase.decorator_transparent_dispatch-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>decorator_transparent_dispatch</code></a></p><p><strong>Examples:</strong></p><pre><code class="language-julia">@decorator_transparent_signature log!(M::AbstractDecoratorManifold, X, p, q)
@decorator_transparent_signature log!(M::TD, X, p, q) where {TD&lt;:AbstractDecoratorManifold}
@decorator_transparent_signature isapprox(M::AbstractDecoratorManifold, p, q; kwargs...)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.decorated_manifold-Tuple{Manifold}" href="#ManifoldsBase.decorated_manifold-Tuple{Manifold}"><code>ManifoldsBase.decorated_manifold</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">decorated_manifold(M::AbstractDecoratorManifold)</code></pre><p>Return the manifold decorated by the decorator <code>M</code>. Defaults to <code>M.manifold</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.decorator_transparent_dispatch-Tuple{Any,Manifold,Vararg{Any,N} where N}" href="#ManifoldsBase.decorator_transparent_dispatch-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>ManifoldsBase.decorator_transparent_dispatch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">decorator_transparent_dispatch(f, M::Manifold, args...) -&gt; Val</code></pre><p>Given a <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> <code>M</code> and a function <code>f(M,args...)</code>, indicate, whether a function is <code>Val(:transparent)</code> or <code>Val(:intransparent)</code> for the (decorated) <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> <code>M</code>. Another possibility is, that for <code>M</code> and given <code>args...</code> the function <code>f</code> should invoke <code>M</code>s <code>Val(:parent)</code> implementation, see <a href="decorator.html#ManifoldsBase.@decorator_transparent_function-Tuple{Any}"><code>@decorator_transparent_function</code></a> for details.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.default_decorator_dispatch-Tuple{Manifold}" href="#ManifoldsBase.default_decorator_dispatch-Tuple{Manifold}"><code>ManifoldsBase.default_decorator_dispatch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">default_decorator_dispatch(M) -&gt; Val</code></pre><p>Return whether by default to dispatch the the inner manifold of a decorator (<code>Val(true)</code>) or not (<code>Val(false</code>). For more details see <a href="decorator.html#ManifoldsBase.is_decorator_transparent-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>is_decorator_transparent</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.is_decorator_transparent-Tuple{Any,Manifold,Vararg{Any,N} where N}" href="#ManifoldsBase.is_decorator_transparent-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>ManifoldsBase.is_decorator_transparent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_decorator_transparent(f, M::Manifold, args...) -&gt; Bool</code></pre><p>Given a <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> <code>M</code> and a function <code>f(M, args...)</code>, indicate, whether an <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a> acts transparently for <code>f</code>. This means, it just passes through down to the internally stored manifold. Transparency is only defined for decorator manifolds and by default all decorators are transparent. A function that is affected by the decorator indicates this by returning <code>false</code>. To change this behaviour, see <a href="decorator.html#ManifoldsBase.decorator_transparent_dispatch-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>decorator_transparent_dispatch</code></a>.</p><p>If a decorator manifold is not in general transparent, it might still pass down for the case that a decorator is the default decorator, see <a href="decorator.html#ManifoldsBase.is_default_decorator-Tuple{Manifold}"><code>is_default_decorator</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ManifoldsBase.is_default_decorator-Tuple{Manifold}" href="#ManifoldsBase.is_default_decorator-Tuple{Manifold}"><code>ManifoldsBase.is_default_decorator</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_default_decorator(M) -&gt; Bool</code></pre><p>For any manifold that is a subtype of <a href="decorator.html#ManifoldsBase.AbstractDecoratorManifold"><code>AbstractDecoratorManifold</code></a>, this function indicates whether a certain manifold <code>M</code> acts as a default decorator.</p><p>This yields that <em>all</em> functions are passed through to the decorated <a href="../interface.html#ManifoldsBase.Manifold"><code>Manifold</code></a> if <code>M</code> is indicated as default. This overwrites all <a href="decorator.html#ManifoldsBase.is_decorator_transparent-Tuple{Any,Manifold,Vararg{Any,N} where N}"><code>is_decorator_transparent</code></a> values.</p><p>This yields the following advantange: For a manifold one usually implicitly assumes for example a metric. To avoid reimplementation of this metric when introducing a second metric, the first metric can be set to be the default, i.e. its implementaion is already given by the undecorated case.</p><p>Value returned by this function is determined by <a href="decorator.html#ManifoldsBase.default_decorator_dispatch-Tuple{Manifold}"><code>default_decorator_dispatch</code></a>, which returns a <code>Val</code>-wrapped boolean for type stability of certain functions.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="vector_bundle.html">« Vector bundle</a><a class="docs-footer-nextpage" href="array.html">Array manifold »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 13 March 2020 21:39">Friday 13 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
